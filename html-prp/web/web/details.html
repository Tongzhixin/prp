<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>漏洞详细信息</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
	

	

  	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- <link href='https://fonts.googleapis.com/css?family=Work+Sans:400,300,600,400italic,700' rel='stylesheet' type='text/css'> -->
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->
	<script src="echarts/echarts.min.js"></script>
	<script src="echarts/world.js"></script>
	<link rel="apple-touch-icon" sizes="76x76" href="images/apple-icon.png">
	<link rel="icon" type="image/png" sizes="96x96" href="images/favicon.png">

	<!-- Prism JS -->
	<script src="js/prism.js"></script>
	<link rel="stylesheet" href="css/prism.css">

	</head>
	<body>
		
	<div class="fh5co-loader"></div>
	
	<div id="page">
	<nav class="fh5co-nav" role="navigation">
		<div class="container">
			<div class="row">
				<div class="col-xs-2">
				</div>
				<div class="col-xs-10 text-right menu-1">
					<div class="navbar-form navbar-left">
						<div class="input-group">
							<input type="text" id="getUrl" value="" class="form-control" style="width: 300px;height: 35px;background-color: white" placeholder="请输入要查询的CWE编号...">
							<button type="button" id="search" class="btn btn-default" onclick="search()" style="background-color: #ff5931;border-color: #ff5931;color: white;height: 35px">查询</button>
						</div>
					</div>
					<ul>
						<li><a href="index.html" style="color: white"><strong>首页</strong></a></button></li>
						<li><a href="introduction.html" style="color: white"><strong>项目简介</strong></a></li>
						<li><a href="vulnerability.html" style="color: white"><strong>漏洞列表</strong></a></li>
						<li><a href="goodCode.html" style="color: white"><strong>正样本</strong></a></li>
						<li class="has-dropdown">
							<a style="color: white"><strong>帮助</strong></a>
							<ul class="dropdown">
								<li><a href="help.html" style="color: black"><strong>如何使用</strong></a></li>
								<li><a href="about.html" style="color: black"><strong>关于我们</strong></a></li>
							</ul>
						</li>
						<li class="btn-cta" title="下载数据" id="download" style="color: white"><a href="/vulnerability.zip"><span><strong>下载</strong></span></a></li>
					</ul>
				</div>
			</div>
			
		</div>
	</nav>

	<header id="fh5co-header" class="fh5co-cover" role="banner" style="background-image:url(images/img_bg_2.jpg);height: 110px">
		<div class="overlay"></div>
	</header>

	<div class="fh5co-bg-section">
		<div class="container">
			<div class="row">
				<div class="col-md-12" style="height: 50px"></div>
				<div class="col-md-12" id="mainbody">
					<div  class="col-md-12" style="height: 50px">
						<span style="font-size: large; color: black" class="text-left"><strong>漏洞详细信息</strong></span>
					</div>
					<div  class="col-md-12" style="height: 50px">
						<span style="font-size: x-large; color: deepskyblue" class="text-left" id="vulnerability_name"><strong></strong></span>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">漏洞编号：</span>
							<span style="font-size: small; color: black" id="vulnerability_id"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">危险等级：</span>
							<span style="font-size: small; color: black" id="danger"></span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">CWE编号：</span>
							<span style="font-size: small; color: black" id="cwe_id"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">漏洞类型：</span>
							<span style="font-size: small; color: black" id="vulnerability_type"></span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">发布时间：</span>
							<span style="font-size: small; color: black" id="release_time"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">威胁类型：</span>
							<span style="font-size: small; color: black" id="threat_type"></span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">更新时间：</span>
							<span style="font-size: small; color: black" id="change_time"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">厂商：</span>
							<span style="font-size: small; color: black">未知</span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">编写语言：</span>
							<span style="font-size: small; color: black" id="language"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">漏洞来源：</span>
							<span style="font-size: small; color: black" id="source"></span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">机密性：</span>
							<span style="font-size: small; color: black" id="confidentiality"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">攻击向量：</span>
							<span style="font-size: small; color: black" id="attack_vector"></span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">完整性：</span>
							<span style="font-size: small; color: black" id="integrity"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">攻击复杂性：</span>
							<span style="font-size: small; color: black" id="attack_complexity"></span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">可用性：</span>
							<span style="font-size: small; color: black" id="availability"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">访问向量：</span>
							<span style="font-size: small; color: black" id="access_vector"></span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">权限要求：</span>
							<span style="font-size: small; color: black" id="privileges_required"></span>
						</div>
						<div class="col-md-6" style="height: 20px">
							<span style="font-size: small; color: black">访问复杂性：</span>
							<span style="font-size: small; color: black" id="access_complexity"></span>
						</div>
					</div>
					<div class="col-md-7">
						<div class="col-md-6" style="height: 50px">
							<span style="font-size: small; color: black">认证：</span>
							<span style="font-size: small; color: black" id="authentication"></span>
						</div>
						<div class="col-md-6" style="height: 50px">
							<span style="font-size: small; color: black">用户交互：</span>
							<span style="font-size: small; color: black" id="ui"></span>
						</div>
					</div>
					<div  class="col-md-12">
						<span style="font-size: large; color: black" class="text-left"><strong>漏洞描述</strong></span>
						<div class="col-md-12">
							<p class="text-left" style="color: black" id="description"></p>
						</div>
					</div>
					<div  class="col-md-12">
						<span style="font-size: large; color: black" class="text-left"><strong>漏洞代码</strong></span>
						<div class="col-md-12">
							<pre><code class="language-c" id="code"></code></pre>
						</div>
					</div>
					<div  class="col-md-12">
						<span style="font-size: large; color: black" class="text-left"><strong>漏洞POC</strong></span>
						<div class="col-md-12">
							<pre><code class="language-c" id="poc"></code></pre>
						</div>
					</div>
					<div  class="col-md-12">
						<span style="font-size: large; color: black" class="text-left"><strong>修补后代码</strong></span>
						<div class="col-md-12">
							<pre><code class="language-c" id="patch_code"></code></pre>
						</div>
					</div>
					<div  class="col-md-12">
						<span style="font-size: large; color: black" class="text-left"><strong>漏洞公告</strong></span>
						<div class="col-md-12">
							<p class="text-left" style="color: black" id="announcement"></p>
						</div>
					</div>
					<div  class="col-md-12">
						<span style="font-size: large; color: black" class="text-left"><strong>参考网址</strong></span>
						<div class="col-md-12">
							<p class="text-left" style="color: black">暂无</p>
						</div>
					</div>
					<div  class="col-md-12">
						<span style="font-size: large; color: black" class="text-left"><strong>受影响产品</strong></span>
						<div class="col-md-12">
							<p class="text-left" style="color: black">暂无</p>
						</div>
					</div>
					<div  class="col-md-12">
						<span style="font-size: large; color: black" class="text-left"><strong>漏洞补丁</strong></span>
						<div class="col-md-12">
							<p class="text-left" style="color: black" id="patch"></p>
						</div>
					</div>
					<div  class="col-md-12" style="height: 50px"></div>
				</div>
		</div>
	</div>

	<footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						<small class="block">&copy; 2019 <a href="about.html" target="_blank" title="Wings">Lab</a> - <a>5212</a></small>
					</p>
				</div>
			</div>
		</div>
	</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Main -->
	<script src="js/main.js"></script>

	<script>
		var name = window.location.href.split('#')[1];
		$.ajax({
			type:"get",
			async:true,
			url:"details.php?" + name,
			timeout:30000,
			dataType:"json",
			success:function(result){
				if(result.length == 0){
					document.getElementById('mainbody').innerHTML = "";
					alert("编号为" + name.split('=')[1] + "的漏洞不存在！")
				} else{
					document.getElementById('vulnerability_name').innerHTML = result[0].name;
					document.getElementById('vulnerability_id').innerHTML = result[0].id;
					if(result[0].CWE_id == null){
	                    document.getElementById('cwe_id').innerHTML = "未知";
					} else {
						document.getElementById('cwe_id').innerHTML = result[0].CWE_id;
					}
					if(result[0].release_time == null){
	                    document.getElementById('release_time').innerHTML = "未知";
					} else {
						document.getElementById('release_time').innerHTML = result[0].release_time;
					}
					if(result[0].change_time == null){
	                    document.getElementById('change_time').innerHTML = "未知";
					} else {
						document.getElementById('change_time').innerHTML = result[0].change_time;
					}
					if(result[0].language == null){
	                    document.getElementById('language').innerHTML = "未知";
					} else {
						document.getElementById('language').innerHTML = result[0].language;
					}
					if(result[0].confidentiality == null){
	                    document.getElementById('confidentiality').innerHTML = "未知";
					} else {
						document.getElementById('confidentiality').innerHTML = result[0].confidentiality;
					}
					if(result[0].integrity == null){
	                    document.getElementById('integrity').innerHTML = "未知";
					} else {
						document.getElementById('integrity').innerHTML = result[0].integrity;
					}
					if(result[0].availability == null){
	                    document.getElementById('availability').innerHTML = "未知";
					} else {
						document.getElementById('availability').innerHTML = result[0].availability;
					}
					if(result[0].privileges_required == null){
	                    document.getElementById('privileges_required').innerHTML = "未知";
					} else {
						document.getElementById('privileges_required').innerHTML = result[0].privileges_required;
					}
					if(result[0].authentication == null){
	                    document.getElementById('authentication').innerHTML = "未知";
					} else {
						document.getElementById('authentication').innerHTML = result[0].authentication;
					}
					if(result[0].danger == null){
	                    document.getElementById('danger').innerHTML = "未知";
					} else {
						document.getElementById('danger').innerHTML = result[0].danger;
					}
					if(result[0].vulnerability_type == null){
	                    document.getElementById('vulnerability_type').innerHTML = "其他";
					} else {
						document.getElementById('vulnerability_type').innerHTML = result[0].vulnerability_type;
					}
					if(result[0].threat_type == null){
	                    document.getElementById('threat_type').innerHTML = "未知";
					} else {
						document.getElementById('threat_type').innerHTML = result[0].threat_type;
					}
					if(result[0].source == null){
	                    document.getElementById('source').innerHTML = "未知";
					} else {
						document.getElementById('source').innerHTML = result[0].source;
					}
					if(result[0].attack_vector == null){
	                    document.getElementById('attack_vector').innerHTML = "未知";
					} else {
						document.getElementById('attack_vector').innerHTML = result[0].attack_vector;
					}
					if(result[0].attack_complexity == null){
	                    document.getElementById('attack_complexity').innerHTML = "未知";
					} else {
						document.getElementById('attack_complexity').innerHTML = result[0].attack_complexity;
					}
					if(result[0].access_vector == null){
	                    document.getElementById('access_vector').innerHTML = "未知";
					} else {
						document.getElementById('access_vector').innerHTML = result[0].access_vector;
					}
					if(result[0].access_complexity == null){
	                    document.getElementById('access_complexity').innerHTML = "未知";
					} else {
						document.getElementById('access_complexity').innerHTML = result[0].access_complexity;
					}
					if(result[0].ui == null){
	                    document.getElementById('ui').innerHTML = "未知";
					} else {
						document.getElementById('ui').innerHTML = result[0].UI;
					}
					if(result[0].description == null){
	                    document.getElementById('description').innerHTML = "暂无";
					} else {
						document.getElementById('description').innerHTML = result[0].description;
					}
					if(result[0].code == null){
	                    document.getElementById('code').innerHTML = "暂无";
					} else {
						document.getElementById('code').innerHTML = result[0].code;
					}
					if(result[0].poc == null){
	                    document.getElementById('poc').innerHTML = "暂无";
					} else {
						document.getElementById('poc').innerHTML = result[0].POC;
					}
					if(result[0].patch_code == null){
	                    document.getElementById('patch_code').innerHTML = "暂无";
					} else {
						document.getElementById('patch_code').innerHTML = result[0].patch_code;
					}
					if(result[0].announcement == null){
	                    document.getElementById('announcement').innerHTML = "暂无";
					} else {
						document.getElementById('announcement').innerHTML = result[0].announcement;
					}
					if(result[0].patch == null){
	                    document.getElementById('patch').innerHTML = "暂无";
					} else {
						document.getElementById('patch').innerHTML = result[0].patch;
					}
					Prism.highlightAll();
				}
			},
			error:function(){
				alert("获取数据失败！");
			}
		});
	</script>

	<script>
		var legalArray = ['1','2','3','4','5','6','7','8','9','0'];
		function search() {
			var input = document.getElementById('getUrl').value;
            if(input === ''){
                alert('CWE编号不能为空！');
            } else {
            	var flag = true;
            	if(input.length < 4){
            		flag = false;
            	} else {
					if(input[0] != 'C' && input[0] != 'c'){
	            		flag = false;
	            	}
	            	if(input[1] != 'W' && input[1] != 'w'){
	            		flag = false;
	            	}
	            	if(input[2] != 'E' && input[2] != 'e'){
	            		flag = false;
	            	}
	            	for(var i = 3; i < input.length; i++){
	                    if(legalArray.indexOf(input[i]) > -1){}
	                    else{
	                        alert(input[i]);
	                        flag = false;
	                        break;
	                    }
	                }
            	}
                if(flag == false){
                    alert('CWE编号不合法');
                }
                else{
                    window.location = 'search.html#' + input;
                }
            }
		}
		$('#getUrl').bind('keydown',function(event){
	        if(event.keyCode == "13") {
	            var input = document.getElementById('getUrl').value;
	            if(input === ''){
	                alert('CWE编号不能为空！');
	            } else {
	            	var flag = true;
	            	if(input.length < 4){
	            		flag = false;
	            	} else {
						if(input[0] != 'C' && input[0] != 'c'){
		            		flag = false;
		            	}
		            	if(input[1] != 'W' && input[1] != 'w'){
		            		flag = false;
		            	}
		            	if(input[2] != 'E' && input[2] != 'e'){
		            		flag = false;
		            	}
		            	for(var i = 3; i < input.length; i++){
		                    if(legalArray.indexOf(input[i]) > -1){}
		                    else{
		                        alert(input[i]);
		                        flag = false;
		                        break;
		                    }
		                }
	            	}
	                if(flag == false){
	                    alert('CWE编号不合法');
	                }
	                else{
	                    window.location = 'search.html#' + input;
	                }
	            }
	        }
	    });
	</script>

	</script>

	</body>
</html>

