<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>正样本</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />




	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- <link href='https://fonts.googleapis.com/css?family=Work+Sans:400,300,600,400italic,700' rel='stylesheet' type='text/css'> -->

	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->
	<script src="echarts/echarts.min.js"></script>
	<link rel="apple-touch-icon" sizes="76x76" href="images/apple-icon.png">
	<link rel="icon" type="image/png" sizes="96x96" href="images/favicon.png">

</head>
<body>

<div class="fh5co-loader"></div>

<div id="page">
	<nav class="fh5co-nav" role="navigation">
		<div class="container">
			<div class="row">
				<div class="col-xs-2">
				</div>
				<div class="col-xs-10 text-right menu-1">
					<div class="navbar-form navbar-left">
						<div class="input-group">
							<input type="text" id="getUrl" value="" class="form-control" style="width: 300px;height: 35px;background-color: white" placeholder="请输入要查询的CWE编号...">
							<button type="button" id="search" class="btn btn-default" onclick="search()" style="background-color: #ff5931;border-color: #ff5931;color: white;height: 35px">查询</button>
						</div>
					</div>
					<ul>
						<li><a href="index.html" style="color: white"><strong>首页</strong></a></li>
						<li><a href="introduction.html" style="color: white"><strong>项目简介</strong></a></li>
						<li><a href="vulnerability.html" style="color: white"><strong>漏洞列表</strong></a></li>
						<li><button style="height: 40px; background-color: #1e2839;border-width: 0px"><a href="goodCode.html" style="color: white"><strong>正样本</strong></a></button></li>
						<li class="has-dropdown">
							<a style="color: white"><strong>帮助</strong></a>
							<ul class="dropdown">
								<li><a href="help.html" style="color: black"><strong>如何使用</strong></a></li>
								<li><a href="about.html" style="color: black"><strong>关于我们</strong></a></li>
							</ul>
						</li>
						<li class="btn-cta" title="下载数据" id="download" style="color: white"><a href="/vulnerability.zip"><span><strong>下载</strong></span></a></li>
					</ul>
				</div>
			</div>

		</div>
	</nav>

	<header id="fh5co-header" class="fh5co-cover fh5co-cover-sm" role="banner" style="background-image:url(images/img_bg_2.jpg); height: 110px">
		<div class="overlay"></div>
	</header>
	
	<div id="fh5co-bg-section">
		<div class="container">
			<div class="row">
				<div class="col-md-12 animate-box">
					<span style="font-size: large; color: black;height: 50px" class="text-left"><strong>漏洞列表</strong></span>
					<table class="table table-hover" style="color:black;">
						<thead>
						<tr>
							<th>#</th>
							<th>函数名</th>
						</tr>
						</thead>
						<tbody id="tb"></tbody>
					</table>
					<div style="height: 100px;width: 100%" id="loadingChart"></div>
					<div class="col-md-12 text-center">
						<span style="color: black" id="totalNumber">正样本总数：</span>
						<a id="front" class="btn btn-primary" onclick="frontPage()" href="#">上一页</a>
						<span id="nowpage" style="color: black">1/1</span>
						<a id="next" class="btn btn-primary" onclick="nextPage()" href="#">下一页</a>
						<input id="inputPage" type="number" style="width: 80px" min="1"></input>
						<a id="jump" class="btn btn-primary" onclick="jumpPage()">跳转</a>
					</div>
					<div style="height: 100px"></div>
				</div>
			</div>
		</div>
	</div>

	<footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						<small class="block">&copy; 2019 <a href="about.html" target="_blank" title="Wings">Lab</a> - <a>5212</a></small>
					</p>
				</div>
			</div>
		</div>
	</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Main -->
	<script src="js/main.js"></script>

	<script>
		var loadChart = echarts.init(document.getElementById('loadingChart'));
		loadChart.showLoading();
		var code = '';
		var totalPage;
		var totalNumber;
		var nowPage = 1;
		var number = 50;
		$.ajax({
			type: "get",
			async: true,
			url: "goodnumber.php",
			timeout: 30000,
			success: function(result) {
				totalNumber = result;
				document.getElementById('totalNumber').innerHTML = "正样本总数：" + totalNumber.toString();
				totalPage = Math.ceil(totalNumber / 50);
				document.getElementById('nowpage').innerHTML = "1/" + totalPage.toString();
				document.getElementById('front').className = 'btn btn-default disabled';
                document.getElementById('front').style = "color: #5f615e;background-color: #b4b7b2";
                document.getElementById('inputPage').max = totalPage;
			}
		});
		$.ajax({
			type: "get",
			async: true,
			url: "goodCode.php?start=" + (nowPage-1)*50 + "&num=" + number,
			timeout: 30000,
			dataType: "json",
			success: function(result) {
				for(var i = number-1; i >= 0; i--){
					code += '<tr><th>';
					code += result[i].id;
					code += '</th><th><a href="gooddetails.html#name=';
					code += result[i].name;
					code += '">';
					if (result[i].name.length <= 45){
						code += result[i].name;
					} else {
						code += result[i].name.substring(0,40) + '... ...';
					}
					code += '</a></th></tr>';
				}
				document.getElementById('loadingChart').style = "height: 100px;width: 100%; display: none";
                document.getElementById('tb').innerHTML = code;                
			},
			error: function() {
				alert("获取数据失败！");
			}
		});


		function frontPage(){
            code = '';
            if(nowPage == totalPage){
                document.getElementById('next').className = 'btn btn-primary';
                document.getElementById('next').style = "";
            }
            nowPage -= 1;
            number = 50;
            if(nowPage == 1){
                document.getElementById('front').className = 'btn btn-default disabled';
                document.getElementById('front').style = "color: #5f615e;background-color: #b4b7b2";
            }
            document.getElementById('nowpage').innerHTML = nowPage + '/' + totalPage;
            $.ajax({
				type: "get",
				async: true,
				url: "goodCode.php?start=" + (nowPage-1)*50 + "&num=" + number,
				timeout: 30000,
				dataType: "json",
				success: function(result) {
					for(var i = number-1; i >= 0; i--){
						code += '<tr><th>';
						code += result[i].id;
						code += '</th><th><a href="gooddetails.html#name=';
						code += result[i].name;
						code += '">';
						if (result[i].name.length <= 45){
							code += result[i].name;
						} else {
							code += result[i].name.substring(0,40) + '... ...';
						}
						code += '</a></th></tr>';
					}
					window.scrollTo(0,0);
	                document.getElementById('tb').innerHTML = code;                
				},
				error: function() {
					alert("获取数据失败！");
				}
			});
        }


		function nextPage(){
            code = '';
            if(nowPage == 1){
                document.getElementById('front').className = 'btn btn-primary';
                document.getElementById('front').style = "";
			}
            nowPage += 1;
            number = 50;
            if(nowPage == totalPage){
                number = totalNumber - 50 * (nowPage-1)
                document.getElementById('next').className = 'btn btn-default disabled';
                document.getElementById('next').style = "color: #5f615e;background-color: #b4b7b2";
			}
            document.getElementById('nowpage').innerHTML = nowPage + '/' + totalPage;
            $.ajax({
				type: "get",
				async: true,
				url: "goodCode.php?start=" + (nowPage-1)*50 + "&num=" + number,
				timeout: 30000,
				dataType: "json",
				success: function(result) {
					for(var i = number-1; i >= 0; i--){
						code += '<tr><th>';
						code += result[i].id;
						code += '</th><th><a href="gooddetails.html#name=';
						code += result[i].name;
						code += '">';
						if (result[i].name.length <= 45){
							code += result[i].name;
						} else {
							code += result[i].name.substring(0,40) + '... ...';
						}
						code += '</a></th></tr>';
					}
					window.scrollTo(0,0);
	                document.getElementById('tb').innerHTML = code;                
				},
				error: function() {
					alert("获取数据失败！");
				}
			});
		}


		function jumpPage() {
		    code = '';
            var input = parseInt(document.getElementById('inputPage').value);
            if(input != null){
                if(input < 1 || input > totalPage){
                    alert("页码超出范围");
				}
				else{
                    if(nowPage == totalPage){
                        document.getElementById('next').className = 'btn btn-primary';
                        document.getElementById('next').style = "";
                    }
                    if(nowPage == 1){
                        document.getElementById('front').className = 'btn btn-primary';
                        document.getElementById('front').style = "";
                    }
                    nowPage = input;
                    number = 50;
                    if(nowPage == totalPage){
                        number = totalNumber - 50 * (nowPage-1)
                        document.getElementById('next').className = 'btn btn-default disabled';
                        document.getElementById('next').style = "color: #5f615e;background-color: #b4b7b2";
                    }
                    if(nowPage == 1){
                        document.getElementById('front').className = 'btn btn-default disabled';
                        document.getElementById('front').style = "color: #5f615e;background-color: #b4b7b2";
                    }
                    document.getElementById('nowpage').innerHTML = nowPage + '/' + totalPage;
                    $.ajax({
						type: "get",
						async: true,
						url: "goodCode.php?start=" + (nowPage-1)*50 + "&num=" + number,
						timeout: 30000,
						dataType: "json",
						success: function(result) {
							for(var i = number-1; i >= 0; i--){
								code += '<tr><th>';
								code += result[i].id;
								code += '</th><th><a href="gooddetails.html#name=';
								code += result[i].name;
								code += '">';
								if (result[i].name.length <= 45){
									code += result[i].name;
								} else {
									code += result[i].name.substring(0,40) + '... ...';
								}
								code += '</a></th></tr>';
							}
							window.scrollTo(0,0);
			                document.getElementById('tb').innerHTML = code;
						},
						error: function() {
							alert("获取数据失败！");
						}
					});
				}
			}
        }

        $('#inputPage').bind('keydown',function(event){
	        if(event.keyCode == "13") {
	            code = '';
	            var input = parseInt(document.getElementById('inputPage').value);
	            if(input != null){
	                if(input < 1 || input > totalPage){
	                    alert("页码超出范围");
					}
					else{
	                    if(nowPage == totalPage){
	                        document.getElementById('next').className = 'btn btn-primary';
	                        document.getElementById('next').style = "";
	                    }
	                    if(nowPage == 1){
	                        document.getElementById('front').className = 'btn btn-primary';
	                        document.getElementById('front').style = "";
	                    }
	                    nowPage = input;
	                    number = 50;
	                    if(nowPage == totalPage){
	                        number = totalNumber - 50 * (nowPage-1)
	                        document.getElementById('next').className = 'btn btn-default disabled';
	                        document.getElementById('next').style = "color: #5f615e;background-color: #b4b7b2";
	                    }
	                    if(nowPage == 1){
	                        document.getElementById('front').className = 'btn btn-default disabled';
	                        document.getElementById('front').style = "color: #5f615e;background-color: #b4b7b2";
	                    }
	                    document.getElementById('nowpage').innerHTML = nowPage + '/' + totalPage;
	                    $.ajax({
							type: "get",
							async: true,
							url: "goodCode.php?start=" + (nowPage-1)*50 + "&num=" + number,
							timeout: 30000,
							dataType: "json",
							success: function(result) {
								for(var i = number-1; i >= 0; i--){
									code += '<tr><th>';
									code += result[i].id;
									code += '</th><th><a href="gooddetails.html#name=';
									code += result[i].name;
									code += '">';
									if (result[i].name.length <= 45){
										code += result[i].name;
									} else {
										code += result[i].name.substring(0,40) + '... ...';
									}
									code += '</a></th></tr>';
								}
								window.scrollTo(0,0);
				                document.getElementById('tb').innerHTML = code;
							},
							error: function() {
								alert("获取数据失败！");
							}
						});
					}
				}
	        }
	    });
	</script>

	<script>
		var legalArray = ['1','2','3','4','5','6','7','8','9','0'];
		function search() {
			var input = document.getElementById('getUrl').value;
            if(input === ''){
                alert('CWE编号不能为空！');
            } else {
            	var flag = true;
            	if(input.length < 4){
            		flag = false;
            	} else {
					if(input[0] != 'C' && input[0] != 'c'){
	            		flag = false;
	            	}
	            	if(input[1] != 'W' && input[1] != 'w'){
	            		flag = false;
	            	}
	            	if(input[2] != 'E' && input[2] != 'e'){
	            		flag = false;
	            	}
	            	for(var i = 3; i < input.length; i++){
	                    if(legalArray.indexOf(input[i]) > -1){}
	                    else{
	                        alert(input[i]);
	                        flag = false;
	                        break;
	                    }
	                }
            	}
                if(flag == false){
                    alert('CWE编号不合法');
                }
                else{
                    window.location = 'search.html#' + input;
                }
            }
		}
		$('#getUrl').bind('keydown',function(event){
	        if(event.keyCode == "13") {
	            var input = document.getElementById('getUrl').value;
	            if(input === ''){
	                alert('CWE编号不能为空！');
	            } else {
	            	var flag = true;
	            	if(input.length < 4){
	            		flag = false;
	            	} else {
						if(input[0] != 'C' && input[0] != 'c'){
		            		flag = false;
		            	}
		            	if(input[1] != 'W' && input[1] != 'w'){
		            		flag = false;
		            	}
		            	if(input[2] != 'E' && input[2] != 'e'){
		            		flag = false;
		            	}
		            	for(var i = 3; i < input.length; i++){
		                    if(legalArray.indexOf(input[i]) > -1){}
		                    else{
		                        alert(input[i]);
		                        flag = false;
		                        break;
		                    }
		                }
	            	}
	                if(flag == false){
	                    alert('CWE编号不合法');
	                }
	                else{
	                    window.location = 'search.html#' + input;
	                }
	            }
	        }
	    });
	</script>

	</body>
</html>

